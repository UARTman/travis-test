language: python
jobs:
  include:
  - name: Python windows
    os: windows
    language: shell
    before_install:
    - choco install openssl
    - choco install anaconda3 --params '"/AddToPath"'
    - "/c/tools/anaconda3/Scripts/conda init bash"
    - "/c/tools/anaconda3/Scripts/activate"
    - source /c/Users/travis/.bash_profile
    - "/c/tools/anaconda3/Scripts/conda install -y m2w64-gcc libpython"
    after_script:
    - powershell "Compress-Archive -Path test.dist -DestinationPath release-$TRAVIS_TAG"
    - ls
  - name: Python linux
    python: 3.7
    before_install:
    - sudo apt-get install -y chrpath
    after_script:
    - "./test.dist/test"
    - tar -cvf release-$TRAVIS_TAG.tar test.dist
    - ls
before_script:
- pip install -r requirements.txt
script:
- python test.py
- python -m nuitka --assume-yes-for-downloads --standalone --experimental=use_pefile
  test.py
deploy:
  provider: releases
  file: release-*
  on:
    tags: true
  password:
    secure: KqgLAwUvC8J0p8k6bPiMBi2ULpWFTMOFyfaAkRfA2u5jx5PsIs7bE3j2+6zenf5qpoaAlcSE4bC2VQzA8r/DGq9RYoA3KU48mAsZFHo0TtzWuvhRhd1Jws5O/Q0y3JTAeFDFFCk3jLaEtgkZ0ky0BBZZddxF0hhVjPC+ob1Ool26OcJowFdkSmIdgZVt1MQOZD0/K8KU3En686kRXrLuU9WtONuPBGPBVoHob4e2DxkX3c5GLNCD+QRMmhq/8WyNzxggP4Ux0IMUHf+s+C/o7rvB/2Me+buVZn4vAQdEOwrRMVt5DS4k49dn/ix6Zl0OO+3RgtHyml7gB36RoKv5noV7xLtG8c74QwaQDBW5Cztulbfg/jT69DMPZcUiHfPMBlAI3WNn9D7EOxYHgpEvj3SHC4qGiYQtZ5FfWTS3XQ8ou5twz2JYC9C8xwS/IJjh11C9D8x/IvbUEG4cuC+/t4JS3tZ36DTq/6QA1LUGmTl6EaFJl9ZsaSX5ecncJANqdiJtBdrUckb2PCTM3AOS0rT5V3HOaoLREZNmThLPPMOtSxbF6norFbA2XwzgeZdVh/D9+/GEjTXJwzJxx4g/acCeyM3+HkpzfDiNgdWzHO0yfW9rHxww11dp79VAY4SVrfJjgfIyKjlAwJJR8/auqG4zmsy37/xvQ2eK75oR2ng=
  user: UARTman
